var app=function(){"use strict";function e(){}function t(e){return e()}function n(){return Object.create(null)}function s(e){e.forEach(t)}function o(e){return"function"==typeof e}function a(e,t){return e!=e?t==t:e!==t||e&&"object"==typeof e||"function"==typeof e}function l(e,t){e.appendChild(t)}function c(e,t,n){e.insertBefore(t,n||null)}function r(e){e.parentNode.removeChild(e)}function u(e){return document.createElement(e)}function i(e){return document.createTextNode(e)}function h(){return i(" ")}function f(e,t,n,s){return e.addEventListener(t,n,s),()=>e.removeEventListener(t,n,s)}function d(e){return function(t){return t.preventDefault(),e.call(this,t)}}function p(e,t,n){null==n?e.removeAttribute(t):e.getAttribute(t)!==n&&e.setAttribute(t,n)}function m(e,t){t=""+t,e.wholeText!==t&&(e.data=t)}function g(e,t){e.value=null==t?"":t}function $(e,t,n,s){e.style.setProperty(t,n,s?"important":"")}function v(e,t,n){e.classList[n?"add":"remove"](t)}let b;function y(e){b=e}function w(){if(!b)throw new Error("Function called outside component initialization");return b}function x(){const e=w();return(t,n)=>{const s=e.$$.callbacks[t];if(s){const o=function(e,t){const n=document.createEvent("CustomEvent");return n.initCustomEvent(e,!1,!1,t),n}(t,n);s.slice().forEach((t=>{t.call(e,o)}))}}}const k=[],C=[],_=[],S=[],M=Promise.resolve();let E=!1;function I(e){_.push(e)}function P(e){S.push(e)}let z=!1;const A=new Set;function N(){if(!z){z=!0;do{for(let e=0;e<k.length;e+=1){const t=k[e];y(t),j(t.$$)}for(y(null),k.length=0;C.length;)C.pop()();for(let e=0;e<_.length;e+=1){const t=_[e];A.has(t)||(A.add(t),t())}_.length=0}while(k.length);for(;S.length;)S.pop()();E=!1,z=!1,A.clear()}}function j(e){if(null!==e.fragment){e.update(),s(e.before_update);const t=e.dirty;e.dirty=[-1],e.fragment&&e.fragment.p(e.ctx,t),e.after_update.forEach(I)}}const O=new Set;let q;function G(e,t){e&&e.i&&(O.delete(e),e.i(t))}function R(e,t,n,s){if(e&&e.o){if(O.has(e))return;O.add(e),q.c.push((()=>{O.delete(e),s&&(n&&e.d(1),s())})),e.o(t)}}function T(e,t){e.d(1),t.delete(e.key)}function L(e,t,n){const s=e.$$.props[t];void 0!==s&&(e.$$.bound[s]=n,n(e.$$.ctx[s]))}function J(e){e&&e.c()}function V(e,n,a,l){const{fragment:c,on_mount:r,on_destroy:u,after_update:i}=e.$$;c&&c.m(n,a),l||I((()=>{const n=r.map(t).filter(o);u?u.push(...n):s(n),e.$$.on_mount=[]})),i.forEach(I)}function B(e,t){const n=e.$$;null!==n.fragment&&(s(n.on_destroy),n.fragment&&n.fragment.d(t),n.on_destroy=n.fragment=null,n.ctx=[])}function F(e,t){-1===e.$$.dirty[0]&&(k.push(e),E||(E=!0,M.then(N)),e.$$.dirty.fill(0)),e.$$.dirty[t/31|0]|=1<<t%31}function H(t,o,a,l,c,u,i=[-1]){const h=b;y(t);const f=t.$$={fragment:null,ctx:null,props:u,update:e,not_equal:c,bound:n(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(h?h.$$.context:o.context||[]),callbacks:n(),dirty:i,skip_bound:!1};let d=!1;if(f.ctx=a?a(t,o.props||{},((e,n,...s)=>{const o=s.length?s[0]:n;return f.ctx&&c(f.ctx[e],f.ctx[e]=o)&&(!f.skip_bound&&f.bound[e]&&f.bound[e](o),d&&F(t,e)),n})):[],f.update(),d=!0,s(f.before_update),f.fragment=!!l&&l(f.ctx),o.target){if(o.hydrate){const e=function(e){return Array.from(e.childNodes)}(o.target);f.fragment&&f.fragment.l(e),e.forEach(r)}else f.fragment&&f.fragment.c();o.intro&&G(t.$$.fragment),V(t,o.target,o.anchor,o.customElement),N()}y(h)}class Y{$destroy(){B(this,1),this.$destroy=e}$on(e,t){const n=this.$$.callbacks[e]||(this.$$.callbacks[e]=[]);return n.push(t),()=>{const e=n.indexOf(t);-1!==e&&n.splice(e,1)}}$set(e){var t;this.$$set&&(t=e,0!==Object.keys(t).length)&&(this.$$.skip_bound=!0,this.$$set(e),this.$$.skip_bound=!1)}}function D(e,t,n){const s=e.slice();return s[9]=t[n],s[11]=n,s}function K(e,t){let n,s,o,a,f,d,g,b,y=t[5](t[9].name)?"[You] ":"",w=t[9].name+"",x=t[9].message+"";return{key:e,first:null,c(){n=u("li"),s=u("span"),o=i(y),a=i(w),f=i(":"),d=h(),g=i(x),b=h(),$(s,"color",t[9].color),p(s,"class","svelte-lz3bvp"),p(n,"class","svelte-lz3bvp"),v(n,"me",t[5](t[9].name)),this.first=n},m(e,t){c(e,n,t),l(n,s),l(s,o),l(s,a),l(s,f),l(n,d),l(n,g),l(n,b)},p(e,l){t=e,2&l&&y!==(y=t[5](t[9].name)?"[You] ":"")&&m(o,y),2&l&&w!==(w=t[9].name+"")&&m(a,w),2&l&&$(s,"color",t[9].color),2&l&&x!==(x=t[9].message+"")&&m(g,x),34&l&&v(n,"me",t[5](t[9].name))},d(e){e&&r(n)}}}function Q(e){let t,n,o,a,i,m;return{c(){t=u("form"),n=u("input"),o=h(),a=u("button"),a.textContent="Send",p(n,"type","text"),p(n,"placeholder","Chat message"),n.required=!0,p(n,"class","svelte-lz3bvp"),p(a,"type","submit"),p(a,"class","svelte-lz3bvp"),p(t,"class","svelte-lz3bvp")},m(s,r){c(s,t,r),l(t,n),g(n,e[0]),l(t,o),l(t,a),i||(m=[f(n,"input",e[7]),f(t,"submit",d(e[4]))],i=!0)},p(e,t){1&t&&n.value!==e[0]&&g(n,e[0])},d(e){e&&r(t),i=!1,s(m)}}}function W(t){let n;return{c(){n=u("a"),n.textContent="Login to Chat",p(n,"href","https://id.twitch.tv/oauth2/authorize?client_id=rlyyav6daabm5yx0d5mtoxh9f6xx6k&redirect_uri=http://localhost:5000&scope=chat:read+chat:edit&response_type=token"),p(n,"class","svelte-lz3bvp")},m(e,t){c(e,n,t)},p:e,d(e){e&&r(n)}}}function U(t){let n,s,o,a=[],i=new Map,f=t[1];const d=e=>e[11];for(let e=0;e<f.length;e+=1){let n=D(t,f,e),s=d(n);i.set(s,a[e]=K(s,n))}function m(e,t){return e[2]?Q:W}let g=m(t),$=g(t);return{c(){n=u("aside"),s=u("ul");for(let e=0;e<a.length;e+=1)a[e].c();o=h(),$.c(),p(s,"class","svelte-lz3bvp"),p(n,"class","svelte-lz3bvp")},m(e,r){c(e,n,r),l(n,s);for(let e=0;e<a.length;e+=1)a[e].m(s,null);t[6](s),l(n,o),$.m(n,null)},p(e,[t]){34&t&&(f=e[1],a=function(e,t,n,s,o,a,l,c,r,u,i,h){let f=e.length,d=a.length,p=f;const m={};for(;p--;)m[e[p].key]=p;const g=[],$=new Map,v=new Map;for(p=d;p--;){const e=h(o,a,p),c=n(e);let r=l.get(c);r?s&&r.p(e,t):(r=u(c,e),r.c()),$.set(c,g[p]=r),c in m&&v.set(c,Math.abs(p-m[c]))}const b=new Set,y=new Set;function w(e){G(e,1),e.m(c,i),l.set(e.key,e),i=e.first,d--}for(;f&&d;){const t=g[d-1],n=e[f-1],s=t.key,o=n.key;t===n?(i=t.first,f--,d--):$.has(o)?!l.has(s)||b.has(s)?w(t):y.has(o)?f--:v.get(s)>v.get(o)?(y.add(s),w(t)):(b.add(o),f--):(r(n,l),f--)}for(;f--;){const t=e[f];$.has(t.key)||r(t,l)}for(;d;)w(g[d-1]);return g}(a,t,d,1,e,f,i,s,T,K,null,D)),g===(g=m(e))&&$?$.p(e,t):($.d(1),$=g(e),$&&($.c(),$.m(n,null)))},i:e,o:e,d(e){e&&r(n);for(let e=0;e<a.length;e+=1)a[e].d();t[6](null),$.d()}}}function X(e,t,n){let{messages:s}=t,{user:o}=t,{value:a=""}=t;const l=x();let c;var r;r=()=>{n(3,c.scrollTop=c.scrollHeight-c.clientHeight,c)},w().$$.after_update.push(r);return e.$$set=e=>{"messages"in e&&n(1,s=e.messages),"user"in e&&n(2,o=e.user),"value"in e&&n(0,a=e.value)},[a,s,o,c,()=>l("submit"),e=>!!o&&e===o.display_name,function(e){C[e?"unshift":"push"]((()=>{c=e,n(3,c)}))},function(){a=this.value,n(0,a)}]}class Z extends Y{constructor(e){super(),H(this,e,X,U,a,{messages:1,user:2,value:0})}}function ee(t){let n,o,a,i,m,$,v,b,y;return{c(){n=u("nav"),o=u("form"),a=u("input"),i=h(),m=u("button"),m.textContent="Submit",$=h(),v=u("button"),v.textContent="Show Chat",p(a,"name","channel"),p(a,"type","text"),a.required=!0,p(a,"placeholder","Enter channel name"),p(a,"class","svelte-sabck1"),p(m,"type","submit"),p(m,"class","svelte-sabck1"),p(o,"class","svelte-sabck1"),p(v,"class","svelte-sabck1"),p(n,"class","svelte-sabck1")},m(e,s){c(e,n,s),l(n,o),l(o,a),g(a,t[0]),l(o,i),l(o,m),l(n,$),l(n,v),b||(y=[f(a,"input",t[3]),f(o,"submit",d(t[1])),f(v,"click",t[2])],b=!0)},p(e,[t]){1&t&&a.value!==e[0]&&g(a,e[0])},i:e,o:e,d(e){e&&r(n),b=!1,s(y)}}}function te(e,t,n){let{channel:s=""}=t;const o=x();return e.$$set=e=>{"channel"in e&&n(0,s=e.channel)},[s,()=>o("submit"),()=>o("toggle"),function(){s=this.value,n(0,s)}]}class ne extends Y{constructor(e){super(),H(this,e,te,ee,a,{channel:0})}}function se(t){let n,s;return{c(){n=u("iframe"),n.src!==(s=t[0])&&p(n,"src",s),p(n,"scrolling","no"),p(n,"frameborder","0"),n.allowFullscreen=!0,p(n,"title","Player"),p(n,"class","svelte-1o82asw")},m(e,t){c(e,n,t)},p(e,[t]){1&t&&n.src!==(s=e[0])&&p(n,"src",s)},i:e,o:e,d(e){e&&r(n)}}}function oe(e,t,n){let{source:s}=t;return e.$$set=e=>{"source"in e&&n(0,s=e.source)},[s]}class ae extends Y{constructor(e){super(),H(this,e,oe,se,a,{source:0})}}function le(e){let t,n,s;function o(t){e[5](t)}let a={user:e[0].user,messages:e[0].messages};return void 0!==e[0].chatMessage&&(a.value=e[0].chatMessage),t=new Z({props:a}),C.push((()=>L(t,"value",o))),t.$on("submit",e[3]),{c(){J(t.$$.fragment)},m(e,n){V(t,e,n),s=!0},p(e,s){const o={};1&s&&(o.user=e[0].user),1&s&&(o.messages=e[0].messages),!n&&1&s&&(n=!0,o.value=e[0].chatMessage,P((()=>n=!1))),t.$set(o)},i(e){s||(G(t.$$.fragment,e),s=!0)},o(e){R(t.$$.fragment,e),s=!1},d(e){B(t,e)}}}function ce(e){let t,n,o,a,i,f,d,m;function g(t){e[4](t)}let $={};void 0!==e[0].channel&&($.channel=e[0].channel),n=new ne({props:$}),C.push((()=>L(n,"channel",g))),n.$on("submit",e[1]),n.$on("toggle",e[2]),f=new ae({props:{source:e[0].playerSource}});let v=!e[0].hiddenChat&&le(e);return{c(){t=u("main"),J(n.$$.fragment),a=h(),i=u("section"),J(f.$$.fragment),d=h(),v&&v.c(),p(i,"class","container svelte-164jwvr"),p(t,"class","app")},m(e,s){c(e,t,s),V(n,t,null),l(t,a),l(t,i),V(f,i,null),l(i,d),v&&v.m(i,null),m=!0},p(e,[t]){const a={};!o&&1&t&&(o=!0,a.channel=e[0].channel,P((()=>o=!1))),n.$set(a);const l={};1&t&&(l.source=e[0].playerSource),f.$set(l),e[0].hiddenChat?v&&(q={r:0,c:[],p:q},R(v,1,1,(()=>{v=null})),q.r||s(q.c),q=q.p):v?(v.p(e,t),1&t&&G(v,1)):(v=le(e),v.c(),G(v,1),v.m(i,null))},i(e){m||(G(n.$$.fragment,e),G(f.$$.fragment,e),G(v),m=!0)},o(e){R(n.$$.fragment,e),R(f.$$.fragment,e),R(v),m=!1},d(e){e&&r(t),B(n),B(f),v&&v.d()}}}function re(e,t,n){let s=null;const o={user:null,channel:null,chatMessage:"",lastChannel:null,hiddenChat:!0,playerSource:null,messages:[]},a=()=>{if(!s)return;const e=localStorage.getItem("token")||"4tsb6t6e3dvndjciewqvkfjvh9vpr8";let t="botleca";o.user&&(t=o.user.login),s.send(`PASS oauth:${e}`),s.send(`NICK ${t}`),s.send("CAP REQ :twitch.tv/tags")},l=e=>{if(s)if(e.data.includes("PRIVMSG")){const{data:t}=e,[s,a]=t.split(/:(.+)/),l=function(e){let t={};return e.split(";").forEach((e=>{const[n,s]=e.split("=");s.trim()?t[n]=s:t[n]=null})),t}(s),c=function(e,t){if(!e)return;let[,n]=t.split(`PRIVMSG #${e} :`);return n?(n=n.replace(//g,""),n):""}(o.lastChannel,a);100===o.messages.length&&n(0,o.messages=o.messages.filter(((e,t)=>0!==t)),o),n(0,o.messages=[...o.messages,{name:l["display-name"],color:l.color??"#615959",message:c}],o)}else e.data.includes("JOIN")?n(0,o.messages=[],o):e.data.includes("PING")&&s.send("PONG :tmi.twitch.tv")};var c;c=async()=>{if(location.hash){const[,e]=location.hash.split(/#/),t=e.split(/&/);for(let e=0;e<t.length;e++){const n=t[e],[s,o]=n.split(/=/);if("access_token"===s){localStorage.setItem("token",o);break}}window.location=window.origin}const e=localStorage.getItem("token");e&&fetch("https://api.twitch.tv/helix/users",{method:"GET",headers:{Authorization:`Bearer ${e}`,"Client-Id":"rlyyav6daabm5yx0d5mtoxh9f6xx6k"}}).then((e=>e.json())).then((e=>{n(0,o.user=e.data[0],o),console.log(e.data[0])})).catch((e=>console.error(e))),s=new WebSocket("wss://irc-ws.chat.twitch.tv:443","irc"),s.onopen=a,s.onmessage=l},w().$$.on_mount.push(c);return[o,()=>{o.channel&&(o.hiddenChat||(o.lastChannel&&s.send(`PART #${o.lastChannel}`),s.send(`JOIN #${o.channel}`)),n(0,o.playerSource=`https://player.twitch.tv/?channel=${o.channel}&parent=localhost`,o),n(0,o.lastChannel=o.channel,o),n(0,o.channel="",o))},()=>{n(0,o.hiddenChat=!o.hiddenChat,o),o.playerSource&&(!o.hiddenChat&&o.lastChannel&&s.send(`JOIN #${o.lastChannel}`),o.hiddenChat&&o.lastChannel&&s.send(`PART #${o.lastChannel}`))},()=>{s&&o.chatMessage&&o.user&&(s.send(`PRIVMSG #${o.channel} :${o.chatMessage}`),n(0,o.messages=[...o.messages,{name:o.user.display_name,color:"#000",message:o.chatMessage}],o),n(0,o.chatMessage="",o))},function(t){e.$$.not_equal(o.channel,t)&&(o.channel=t,n(0,o))},function(t){e.$$.not_equal(o.chatMessage,t)&&(o.chatMessage=t,n(0,o))}]}return new class extends Y{constructor(e){super(),H(this,e,re,ce,a,{})}}({target:document.body})}();
//# sourceMappingURL=bundle.js.map
